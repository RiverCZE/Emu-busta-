<?php
class SystemClass
{

  public $dbHost, $dbName, $dbUser, $dbPass;
  public $dbOther;
  public $page;
  public $name;
  public $idp, $idd, $points, $points_vip;
  public $ladder_blacklist;
  public $points_vote, $link_vote;

  public function database()
  {
    $this->dbOther = new PDO('mysql:host='.$this->dbHost.';dbname='.$this->dbName, $this->dbUser, $this->dbPass);
    $this->dbOther->exec('SET NAMES utf8');
  }

  public function page_name()
  {
    switch($this->page)
    {
      case 'home';
        $page = 'Accueil';
        break;
      case ''; // Si $page est vide
        $page = 'Accueil';
        break;
      case '404';
        $page = 'Erreur 404';
        break;
      case 'rule';
        $page = 'Charte du Serveur';
        break;
      case 'register';
        $page = 'Inscription';
        break;
      case 'welcome';
        $page = 'Bienvenue';
        break;
      case 'disconnect';
        $page = 'Déconnexion';
        break;
      case 'account';
        $page = 'Mon Profil';
        break;
	  case 'contact';
        $page = 'Contact';
        break;
      case 'login';
        $page = 'Connexion';
        break;
      case 'faq';
        $page = 'Foire aux Questions';
        break;
      case 'staff';
        $page = 'Équipe';
        break;
      case 'shop';
        $page = 'Boutique';
        break;
      case 'panier';
        $page = 'Panier';
        break;
      case 'points';
        $page = 'Achat de Points';
        break;
      case 'ladder';
        $page = 'Classement';
        break;
      case 'article';
        $page = 'Article';
        break;
      case 'vote';
        $page = 'Vote';
        break;
      case 'event';
        $page = 'Evènement';
        break;
      case 'maintenance';
        $page = 'Maintenance';
        break;
      case 'commentaire';
        $page = 'Commentaire';
        break;
      /*case '';
        $page = '';
        break;*/
      /*case '';
        $page = '';
        break;*/
      default :
        $page = 'Unknown';
        break;
    }
    return $page;
  }

  public function date_fr($format,$timestamp)
  {
     $date_en = date($format,$timestamp);

     $texte_en = array(
     "Monday", "Tuesday", "Wednesday", "Thursday",
     "Friday", "Saturday", "Sunday", "January",
     "February", "March", "April", "May",
     "June", "July", "August", "September",
     "October", "November", "December"
     );
     $texte_fr = array(
     "Lundi", "Mardi", "Mercredi", "Jeudi",
     "Vendredi", "Samedi", "Dimanche", "Janvier",
     "F&eacute;vrier", "Mars", "Avril", "Mai",
     "Juin", "Juillet", "Ao&ucirc;t", "Septembre",
     "Octobre", "Novembre", "Décembre"
     );
     $date_fr = str_replace($texte_en, $texte_fr, $date_en);
     return $date_fr;
  }

  private function connect()
  {
    if(isset($_SESSION['guid']) && $_SESSION['guid'] != '')
    {
      return TRUE;
    }
    else
    {
      return FALSE;
    }
  }

  private function admin($level=false)
  {
    if($this->connect())
    {
      if($level == false)
      {
        if(@$_SESSION['level'] > 0)
        {
          return TRUE;
        }
        else
        {
          return FALSE;
        }
      }
      elseif(is_numeric($level))
      {
        if(@$_SESSION['level'] >= $level)
        {
          return TRUE;
        }
        else
        {
          return FALSE;
        }
      }
      else
      {
        return FALSE;
      }
    }
    else
    {
      return FALSE;
    }
  }

  public function infos()
  {
    if(isset($_SESSION['guid']) && $_SESSION['guid'] != '' && empty($_SESSION['account']))
    {
      $sql = $this->dbOther->query("SELECT * FROM accounts WHERE guid = '".$_SESSION['guid']."'");
      $_SESSION = $sql->fetch(PDO::FETCH_ASSOC);
    }
  }

  public function acc_info($get) // A éviter d'utiliser
  {
    if(isset($_SESSION['guid']) && $_SESSION['guid'] != '')
    {
      $sql = $this->dbOther->query("SELECT * FROM accounts WHERE guid = '".$_SESSION['guid']."'");
      $data = $sql->fetch(PDO::FETCH_ASSOC);
      return $data[$get];
    }
  }

 public function rank_name($name)
 {
    switch($name)
    {
      case 0:
        $name = 'Normal';
        break;
      case 1:
        $name = 'Animateur';
        break;
      case 2:
        $name = 'Maître du Jeu';
        break;
      case 3:
        $name = 'Chef Maître du Jeu';
        break;
      case 4:
        $name = 'Administrateur';
        break;
      case 5:
        $name = 'Opérateur';
        break;
      default :
        $name = 'Unknown';
        break;
    }
    return $name;
 }

 public function class_name($name)
 {
   switch($name)
   {
     case 1:
       $name = 'Féca';
       break;
     case 2:
       $name = 'Osamodas';
       break;
     case 3:
       $name = 'Enutrof';
       break;
     case 4:
       $name = 'Sram';
       break;
     case 5:
       $name = 'Xélor';
       break;
     case 6:
       $name = 'Ecaflip';
       break;
     case 7:
       $name = 'Eniripsa';
       break;
     case 8:
       $name = 'Iop';
       break;
     case 9:
       $name = 'Crâ';
       break;
     case 10:
       $name = 'Sadida';
       break;
     case 11:
       $name = 'Sacrieur';
       break;
     case 12:
       $name = 'Pandawa';
       break;
   }
   return $name;
 }

 public function align_name($name)
 {
   switch($name)
   {
     case 0:
       $name = 'Neutre';
       break;
     case 1:
       $name = 'Ange';
       break;
     case 2:
       $name = 'Démon';
       break;
     case 3:
       $name = 'Mercenaire';
       break;
   }
   return $name;
 }

 public function sexe_name($name)
 {
   switch($name)
   {
     case 0:
       $name = 'Male';
       break;
     case 1:
       $name = 'Femelle';
       break;
   }
   return $name;
 }

  public function login()
  {
    if(!(isset($_SESSION['guid']) && $_SESSION['guid'] != ''))
    {
      if(isset($_POST['send']) && $_POST['send'] != '')
      {
        $account = htmlentities(@$_POST['account']);
        $password = htmlentities(@$_POST['password']);
        if(isset($account) && $account != '' && isset($password) && $password != '')
        {
          $sql = $this->dbOther->query("SELECT * FROM accounts WHERE account = '".$account."'");
          if($sql->rowCount() > 0)
          {
            $data = $sql->fetch(PDO::FETCH_ASSOC);
            if($data['account'] == $account && $data['pass'] == $password)
            {
              $guid = $data['guid'];
              $_SESSION['guid'] = $guid;
              echo '<center>Bonjour '.ucfirst($account).', bonne visite sur Nestrya !</center>';

              if(@$_POST['auto'])
              {
                setcookie('auto', '1|'.$account.'|'.$password, time()+60*60*24*30);
              }

              header('refresh: 2;url=?page=home');
            }
            else
            {
              echo ERROR_003;
            }
          }
          else
          {
            echo ERROR_002;
          }
        }
        else
        {
          echo ERROR_001;
        }
      }
      else
      {
        echo ERROR_002;
      }
    }
    else
    {
      echo INFO_001;
    }
  }

  public function auto()
  {
    if(!(isset($_SESSION['guid']) && $_SESSION['guid'] != ''))
    {
      if(isset($_COOKIE['auto']) && $_COOKIE['auto'] != '')
      {
        $cookie = explode('|',$_COOKIE['auto']);
        $sql = $this->dbOther->query("SELECT * FROM accounts WHERE account = '".$cookie[1]."'");
        if($sql->rowCount() > 0)
        {
          $data = $sql->fetch(PDO::FETCH_ASSOC);
          if($data['account'] == $cookie[1] && $data['pass'] == $cookie[2])
          {
            $guid = $data['guid'];
            $_SESSION['guid'] = $guid;
            header('location:?page=home');
          }
        }
      }
    }
  }

  public function news()
  {
    $sql = $this->dbOther->query("SELECT * FROM news");
    if($sql->rowCount() > 0)
    {
      $sql = $this->dbOther->query("SELECT COUNT(id) as nbNews FROM news");
      $data = $sql->fetch(PDO::FETCH_ASSOC);
      $nbNews = $data['nbNews'];
      $nbPage = ceil($nbNews/3);
      if(isset($_GET['p']) && $_GET['p'] > 0 && $_GET['p'] <= $nbPage)
      {
        $cPage = $_GET['p'];
      }
      else
      {
        $cPage = 1;
      }

      $sql = $this->dbOther->query("SELECT * FROM news ORDER BY id DESC LIMIT ".(($cPage-1)*3).",3");
      foreach ($sql as $data)
      {
        $Com = $this->dbOther->query("SELECT * FROM commentaires WHERE news = '".$data['id']."'");
        echo '<img src="images/top.png" />
        <div id="mid_corp">
          <div id="text_corp">
            <div class="titre">'.$data['title'].'</div>
            '.($data['image_view'] == 1 ? '<div class="avatar"><img src="'.$data['image_url'].'" /></div>' : null).'
            '.$data['content'].'
            <div style="width:100px;height:1px;clear:both;"></div>
            <div class="date">Ecrit par <b>'.$data['author'].'</b> le '.$this->date_fr('l d F Y à H:i',strtotime($data['date'])).'</div>
            <div class="suite"><a href="'.PAGE.'article&id='.$data['id'].'">Commentaires ('.$Com->rowCount().')</a></div>
          </div>
        </div>
        <img src="images/bottom.png" />';
      }
    }
    else
    {
      echo '<img src="images/top.png" />
      <div id="mid_corp">
        <div id="text_corp">
          <center>Aucune news</center>
        </div>
      </div>
      <img src="images/bottom.png" />';
    }

    if(@$nbNews > 0)
    {
      echo '<img src="images/top.png" />
      <div id="mid_corp">
        <div id="text_corp">
          <center>Pages : ';
      for($i=1;$i<=$nbPage;$i++)
      {
        if($i==$cPage)
        {
          echo '<a href="?page=home&p='.$i.'"><b>'.$i.'</b></a> ';
        }
        else
        {
          echo '<a href="?page=home&p='.$i.'">'.$i.'</a> ';
        }
      }
      echo '</center>
      </div>
      </div>
      <img src="images/bottom.png" />';
    }
  }

  public function register()
  {
    if(!($this->connect()))
    {
      echo '<span class="cambria orange italic size25">Inscription</span>
        <br /><br />';
      $error['account'] = FALSE;
      $error['password'] = FALSE;
      $error['password_c'] = FALSE;
      $error['email'] = FALSE;
      $error['code'] = FALSE;
      $error['rule'] = FALSE;

      if(isset($_POST['send']) && $_POST['send'] != '')
      {
        $account = htmlentities(@$_POST['account']);
        $password = htmlentities(@$_POST['password']);
        $password_c = htmlentities(@$_POST['password_c']);
        $email = htmlentities(@$_POST['email']);
        $code = htmlentities(@$_POST['code']);
        $rule = htmlentities(@$_POST['rule']);

        $register['account'] = FALSE;
        $register['password'] = FALSE;
        $register['email'] = FALSE;
        $register['code'] = FALSE;
        $register['rule'] = FALSE;

        if(isset($account) && $account != '')
        {
          if(preg_match("/^[a-z0-9\-_.]+$/i",$account))
          {
            $sql = $this->dbOther->query("SELECT * FROM accounts WHERE account = '".$account."'");
            if($sql->rowCount() < 1)
            {
              $register['account'] = TRUE;
            }
            else
            {
              $error['account'] = TRUE;
              $errMsg['account'] = '<font color="red">Le nom de compte est déjà utiliser</font>';
            }
          }
          else
          {
            $error['account'] = TRUE;
            $errMsg['account'] = '<font color="red">Le nom de compte n\'est pas valide (Caractères spéciaux)</font>';
          }
        }
        else
        {
          $error['account'] = TRUE;
          $errMsg['account'] = '<font color="red">Veuillez saisir un nom de compte</font>';
        }

        if(isset($password) && $password != '' && isset($password_c) && $password_c != '')
        {
          if(preg_match("/^[a-z0-9\-_.]+$/i",$password))
          {
            if($password == $password_c)
            {
              $register['password'] = TRUE;
            }
            else
            {
              $error['password'] = TRUE;
              $errMsg['password'] = '<font color="red">Les mots de passes ne sont pas identiques</font>';
            }
          }
          else
          {
            $error['password'] = TRUE;
            $errMsg['password'] = '<font color="red">Les mots de passes ne sont pas valides (Caractères spéciaux)</font>';
          }
        }
        else
        {
          $error['password'] = TRUE;
          $errMsg['password'] = '<font color="red">Veuillez saisir un mot de passe</font>';
        }

        if(isset($email) && $email != '')
        {
          if(preg_match("/^[a-z0-9\-_.]+@[a-z0-9\-_.]+\.[a-z]{2,3}$/i",$email))
          {
            $sql = $this->dbOther->query("SELECT * FROM accounts WHERE email = '".$email."'");
            if($sql->rowCount() < 1)
            {
              $register['email'] = TRUE;
            }
            else
            {
              $error['email'] = TRUE;
              $errMsg['email'] = '<font color="red">L\'adresses e-mail est déjà utiliser</font>';
            }
          }
          else
          {
            $error['email'] = TRUE;
            $errMsg['email'] = '<font color="red">L\'adresses e-mail n\'est pas valide</font>';
          }
        }
        else
        {
          $error['email'] = TRUE;
          $errMsg['email'] = '<font color="red">Veuillez saisir une adresse de courriel valide</font>';
        }

        if(isset($code) && $code != '')
        {
          if(strtoupper($code) == $_SESSION['captcha'])
          {
            $register['code'] = TRUE;
          }
          else
          {
            $error['code'] = TRUE;
            $errMsg['code'] = '<font color="red">Le code de sécurité n\'est pas valide</font>';
          }
        }
        else
        {
          $error['code'] = TRUE;
          $errMsg['code'] = '<font color="red">Veuillez saisir le code de sécurité</font>';
        }

        if(isset($rule) && $rule == 'checked')
        {
          $register['rule'] = TRUE;
        }
        else
        {
          $error['rule'] = TRUE;
          $errMsg['rule'] = '<font color="red">Les Conditions Générales d\'Utilisation doivent être lu, compris et accepter</font><br />';
        }

        if($register['account'] && $register['password'] && $register['email'] && $register['code'] && $register['rule'])
        {
          $this->dbOther->query("INSERT INTO accounts (account,pass,email,lastIP) VALUES ('".$account."','".$password."','".$email."','".$_SERVER['REMOTE_ADDR']."')");
          $sql = $this->dbOther->query("SELECT * FROM accounts WHERE account = '".$account."'");
          $data = $sql->fetch(PDO::FETCH_ASSOC);
          $guid = $data['guid'];
          $_SESSION['guid'] = $guid;
          header('location:?page=welcome');
        }
      }

      echo 'Pour vous inscrire et nous rejoindre sur notre serveur de jeu, il vous suffit simplement de remplir les champs ci-dessous.
            Les identifiants que vous choisirez lors de votre inscription seront ceux que vous utiliserez pour vous connecter à nos services.<br /><br />
            <form method="post" action="#">
              <fieldset>
                <legend>Veuillez saisir un nom de compte</legend>
                <p>Le nom de compte choisis sera celui que vous devrez utiliser pour vous connecter au jeu. Celui-ci ne doit contenir que des lettres (A à Z) et/ou des chiffres (0 à 9).</p>
                <label for="account">Nom de compte : </label>'; if($error['account']){ echo $errMsg['account']; } echo '<br />
                <input type="text" id="account" name="account" value="'.@$account.'" />
              </fieldset>
              <fieldset>
                <legend>Veuillez saisir un mot de passe</legend>
                <p>Votre mot de passe est la sécurité de votre compte. N\'oubliez jamais que celui-ci est personnel et qu\'aucun membre de l\'équipe ne vous le demandera ainsi que les autres joueurs. Alors, ne communiquez jamais votre mot de passe et cela peut importe la situation.</p>
                <label for="password">Mot de passe : </label>'; if($error['password']){ echo $errMsg['password']; } echo '<br />
                <input type="password" id="password" name="password" value="'.@$password.'" /><br /><br />
                <label for="password_c">Confirmez votre mot de passe :</label><br />
                <input type="password" id="password_c" name="password_c" value="'.@$password_c.'" />
              </fieldset>
              <fieldset>
                <legend>Veuillez saisir et confirmez une adresse de courriel valide</legend>
                <p>L\'adresse E-mail doit être valide, c\'est votre seule chance de pouvoir récupérer votre mot de passe en cas d\'oubli. Elle vous permet aussi de rester au courant des news apportent du site et serveur.</p>
                <label for="email">Adresse E-mail : </label>'; if($error['email']){ echo $errMsg['email']; } echo '<br />
                <input type="text" id="email" name="email" value="'.@$email.'" />
              </fieldset>
              <fieldset>
                <legend>Veuillez saisir le code de sécurité</legend>
                <p>Le code de sécurité permet d\'optimier les inscriptions en bloquant les bots.</p>
                <label for="code">Code de sécurité : </label>'; if($error['code']){ echo $errMsg['code']; } echo '<br />
                <input type="text" id="code" name="code" value="'.@$code.'" /> : <img src="config/captcha.php" alt="Captcha" />
              </fieldset>
              <fieldset>
                <legend>Veuillez accepter les Conditions Générales d\'Utilisation</legend>
                '; if($error['rule']){ echo $errMsg['rule']; } echo '
                <input type="checkbox" value="checked" name="rule">En cochant cette case, j\'affirme avoir lu et compris les <a href="?page=rule" target="_blank">Conditions Générales d\'Utilisation</a> de nos services et je les accepte.
              </fieldset>
              <center><div class="envoyer"><input type="submit" name="send" value=" " /></div></center>
            </form>';
      }
      else
      {
        echo INFO_001;
      }
  }

  public function profil()
  {
    if($this->connect())
    {
      echo '<span class="cambria orange italic size25">Mon Profil</span>
        <br /><br />
        <span class="profil_menu_left"><a href="?page=account">Gestion du compte</a></span><span class="profil_menu_right"><a href="?page=account&action=settings">Options avancés</a></span>
        <br /><br />
        <span class="profil_menu_left"><a href="?page=account&action=pub">Parrainez des amis</a></span><span class="profil_menu_right"><a href="?page=account&action=avatar">Avatar & Siganture</a></span>
        <br /><br />';

      switch(htmlentities(@$_GET['action']))
      {
        case 'principal' :
          if(isset($_POST['send']) && $_POST['send'] != '')
          {
            if(isset($_POST['personnage']) && $_POST['personnage'] != '')
            {
              if($_POST['personnage'] != 0)
              {
                $sql = $this->dbOther->query("SELECT * FROM personnages WHERE guid = '".htmlentities($_POST['personnage'])."'");
                if($sql->rowCount() > 0)
                {
                  $sql = $this->dbOther->query("SELECT * FROM personnages WHERE guid = '".htmlentities($_POST['personnage'])."'");
                  $data = $sql->fetch(PDO::FETCH_ASSOC);
                  if($_SESSION['guid'] == $data['account'])
                  {
                    $this->dbOther->query("UPDATE accounts SET CharacterPrincipal = '".htmlentities($_POST['personnage'])."' WHERE guid = '".$_SESSION['guid']."'");
                    $_SESSION['CharacterPrincipal'] = htmlentities($_POST['personnage']);
                    header('location:?page=account');
                  }
                  else
                  {
                    echo ERROR_005;
                  }
                }
                else
                {
                  echo ERROR_006;
                }
              }
              else
              {
                echo ERROR_007;
              }
            }
          }

          echo '<fieldset>
              <legend>Personnage principal</legend>
              <div style="margin-top: 20px;">';
          if($_SESSION['CharacterPrincipal'] != 0)
          {
            $sql = $this->dbOther->query("SELECT * FROM personnages WHERE guid = '".$_SESSION['CharacterPrincipal']."'");
            $data = $sql->fetch(PDO::FETCH_ASSOC);
            echo '<img src="images/avatar/classes/'.$data['class'].$data['sexe'].'.jpg" with="50" height="50" style="float: left; border: 2px solid #c0ae7c;" />
                &nbsp; <b>Nom</b> : '.$data['name'].'<br />
                &nbsp; <b>Classe</b> : '.$this->class_name($data['class']).'<br />
                &nbsp; <b>Niveau</b> : '.$data['level'].'<br />
                &nbsp; <b>Alignement</b> : '.$this->align_name($data['alignement']);
          }
          else
          {
            echo '<img src="images/avatar/NO.jpg" with="50" height="50" style="float: left; border: 2px solid #c0ae7c;" />
                &nbsp; <b>Nom</b> : N/A<br />
                &nbsp; <b>Classe</b> : N/A<br />
                &nbsp; <b>Niveau</b> : N/A<br />
                &nbsp; <b>Alignement</b> : N/A';
          }
            echo '</div>
              <div style="margin-top: -70px; margin-right: 10px; float: right;">
                Selection un personnage pricinpal :<br /><br />
                <form method="post" action="#">
                  <span class="send"><select name="personnage" style="text-align:center;">
                    <option value="0">Personnage disponible</options>
                    <option value="0">--------------------</options>';
            $sql = $this->dbOther->query("SELECT * FROM personnages WHERE account = '".$_SESSION['guid']."' ORDER BY guid DESC");
            foreach ($sql as $data)
            {
                echo '<option value="'.$data['guid'].'">'.$data['name'].'</options>';
            }
                  echo '</select></span>
                  <br />
                  <center><div class="envoyer"><input type="submit" value=" " name="send" /></div></center>
                </form>
              </div>
            </fieldset>
            <br />';
          break;
        default :
          if(isset($_POST['send']) && $_POST['send'] != '')
          {
            if(isset($_POST['password_a']) && $_POST['password_a'] != '' && isset($_POST['password']) && $_POST['password'] != '' && isset($_POST['password_c']) && $_POST['password_c'] != '')
            {
              $sql = $this->dbOther->query("SELECT * FROM accounts WHERE guid = '".$_SESSION['guid']."'");
              $data = $sql->fetch(PDO::FETCH_ASSOC);
              if($_POST['password_a'] == $data['pass'])
              {
                if(isset($_POST['email']) && $_POST['email'] != '')
                {
                  if(preg_match('/^[a-z0-9\-_.]+@[a-z0-9\-_.]+\.[a-z]{2,3}$/i',htmlentities($_POST['email'])))
                  {
                    $this->dbOther->query("UPDATE accounts SET email = '".htmlentities($_POST['email'])."' WHERE guid = '".$_SESSION['guid']."'");
                    echo SUCCES_001;
                  }
                  else
                  {
                    echo ERROR_008;
                  }
                }

                if($_POST['password'] == $_POST['password_c'])
                {
                  $this->dbOther->query("UPDATE accounts SET pass = '".htmlentities($_POST['password'])."' WHERE guid = '".$_SESSION['guid']."'");
                  echo SUCCES_002;
                }
                else
                {
                  echo ERROR_009;
                }
              }
            }
            elseif(isset($_POST['password_a']) && $_POST['password_a'] != '' && isset($_POST['email']) && $_POST['email'] != '')
            {
              if(preg_match('/^[a-z0-9\-_.]+@[a-z0-9\-_.]+\.[a-z]{2,3}$/i',htmlentities($_POST['email'])))
              {
                $this->dbOther->query("UPDATE accounts SET email = '".htmlentities($_POST['email'])."' WHERE guid = '".$_SESSION['guid']."'");
                echo SUCCES_001;
              }
              else
              {
                echo ERROR_008;
              }
            }
          }
          echo '<fieldset>
              <legend>Gestion du compte</legend>
              <div style="float: left;">
                <form method="post" action="#">
                  Nouvelle adresse email :<br />
                  <input type="text" name="email" value="" /><br /><br />
                  Ancien mot de pass :<br />
                  <input type="password" name="password_a" value="" /><br /><br />
                  Nouveau mot de pass :<br />
                  <input type="password" name="password" value="" /><br /><br />
                  Confirmation :<br />
                  <input type="password" name="password_c" value="" /><br />
                  <center><div class="envoyer"><input type="submit" value=" " name="send" /></div></center>
                </form>
              </div>
              <div style="float: right; margin-right: 90px;"><br />';
              $sql = $this->dbOther->query("SELECT * FROM accounts WHERE guid = '".$_SESSION['guid']."'");
              $data = $sql->fetch(PDO::FETCH_ASSOC);
                echo '<b>Nom de compte</b> : '.$data['account'].'<br />
                <b>Adresse email</b> : '.$data['email'].'<br />
                <b>Rang</b> : '.$this->rank_name($data['level']).'<br />
                <b>VIP</b> : '.($data['VIP'] == 2 ? '<span style="color:green">Oui</span>' : '<span style="color:#900001">Non</span>').'<br />
                <b>Points</b> : '.$data['points'].' (<a href="?page=points">En acheter</a>)<br />
                <br /><br />
                <u><b>Personnage princiaple</b></u> :
                <br /><br />';
          if($_SESSION['CharacterPrincipal'] != 0)
          {
            $sql = $this->dbOther->query("SELECT * FROM personnages WHERE guid = '".$_SESSION['CharacterPrincipal']."'");
            $data = $sql->fetch(PDO::FETCH_ASSOC);
            echo '<img src="images/avatar/classes/'.$data['class'].$data['sexe'].'.jpg" with="50" height="50" style="float: left; border: 2px solid #c0ae7c;" />
                &nbsp; <b>Nom</b> : '.$data['name'].'<br />
                &nbsp; <b>Classe</b> : '.$this->class_name($data['class']).'<br />
                &nbsp; <b>Niveau</b> : '.$data['level'].'<br />
                &nbsp; <b>Alignement</b> : '.$this->align_name($data['alignement']);
          }
          else
          {
            echo '<img src="images/avatar/NO.jpg" with="50" height="50" style="float: left; border: 2px solid #c0ae7c;" />
                &nbsp; <b>Nom</b> : N/A<br />
                &nbsp; <b>Classe</b> : N/A<br />
                &nbsp; <b>Niveau</b> : N/A<br />
                &nbsp; <b>Alignement</b> : N/A';
          }
                echo '<br /><br />
                <a href="?page=account&action=principal">Changer de personnage principal</a>
              </div>
            </fieldset>
            <fieldset>
          <legend>Mes personnages</legend>';
          $sql = $this->dbOther->query("SELECT * FROM personnages WHERE account = '".$_SESSION['guid']."'");
          if($sql->rowCount() > 0)
          {
            echo '<table border="0" width="100%">
              <th>Nom</th>
              <th>Classe</th>
              <th>Sexe</th>
              <th>Niveau</th>
              <th>Alignement</th>
              <th>Visionner</th>';
            $sql = $this->dbOther->query("SELECT * FROM personnages WHERE account = '".$_SESSION['guid']."' ORDER BY guid DESC");
            foreach ($sql as $data)
            {
                echo '<tr align="center">
                  <td>'.$data['name'].'</td>
                  <td><img src="images/icons/class_'.$data['class'].'.png" title="'.$this->class_name($data['class']).'" width="22" height="22" /></td>
                  <td><img src="images/icons/sexe_'.$data['sexe'].'.png" title="'.$this->sexe_name($data['sexe']).'" /></td>
                  <td>'.$data['level'].'</td>
                  <td><img src="images/icons/align_'.$data['alignement'].'.png" title="'.$this->align_name($data['alignement']).'" width="22" height="22" /></td>
                  <td><a href="?page=armorie&id='.$data['guid'].'"><img src="images/fiche.png" /></a></td>
                <tr>';
            }
            echo '</table>';
          }
          else
          {
            echo INFO_002;
          }
            echo '</fieldset>
            <br />';
          break;
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function shop()
  {
    if($this->connect())
    {
      if(empty($_GET['category']))
      {
        $_GET['category'] = 'home';
      }
      echo '<span class="cambria orange italic size25">Boutique</span>
        <br /><br />';
      switch(htmlentities(@$_GET['category']))
      {
        case 'details':
          if(isset($_GET['id']) && $_GET['id'] != '')
          {
            $sql = $this->dbOther->query("SELECT * FROM shop_list WHERE id = '".$_GET['id']."'");
            if($sql->rowCount() > 0)
            {
              $sql = $this->dbOther->query("SELECT * FROM shop_list WHERE id = '".$_GET['id']."'");
              $data = $sql->fetch(PDO::FETCH_ASSOC);
              echo '<div id="item_tooltip_top"></div>
                <div id="item_tooltip_middle">
                <div align="center">
                <table style="width:97%; border: 1px;" class="item">
                  <tbody>
                    <tr style="background: #4B3E25">
                      <td class="bordure1" colspan="3">
                       <span style="color:#B3C0D9"><b>'.$data['name'].'</b></span><br>
                        <span>Niveau '.$data['level'].'</span>
                      </td>
                      <td class="bordure5" style="text-align: right; vertical-align:middle">
                        Type : '.ucfirst($data['type']).'&nbsp;
                      </td>
                    </tr>
                    <tr style="background: #695C43; text-align: center;">
                      <td style="width:100px;">&nbsp;</td>
                      <td style="width:290px" class="bordure3"><span class="carac_titre">Effets</span></td>
                      <td style="width:100px" class="bordure3"><span class="carac_titre">Conditions</span></td>
                      <td style="width:150px" class="bordure3"><span class="carac_titre">Prix</span></td>
                    </tr>
                    <tr style="background: #695C43">
                      <td style="vertical-align:middle; text-align:center;" class="bordure1">
                        <img width="80" height="80" alt="" src="'.$data['picture'].'"><br /><br />
                      </td>
                      <td style="vertical-align:top" class="bordure4">
                        <span style="color:#005510">'.$data['effets'].'</span><br>
                      </td>
                      <td style="vertical-align:top" class="bordure1">
                        <span></span>
                      </td>
                      <td style="vertical-align:top"  align="center" class="bordure4">
                        <br />
                        <span>'.$data['price'].' Points</span><br />
                        <span>VIP : <font color="#6B0017">-'.$data['reduc'].'%</font> ('.($data['price']-($data['reduc']*$data['price']/100)).')</span><br />
                        <span>Disponible : '.$data['quant'].'</span><br /><br />
                        <span><form method="post" action="?page=shop_buy#corp"><input type="hidden" name="id" value="'.$data['id'].'" /><input type="image" src="images/btn_shop.png" /></form></span>
                      </td>
                    </tr>
                    <tr style="background: #4B3E25">
                      <td class="bordure5" colspan="4"><span class="description_item">'.$data['desc'].'</span></td>
                    </tr>
                  </tbody>
                </table>
                </div>
                </div>
                <div id="item_tooltip_bottom"></div>
                <br /><div align="right"><a href="?page=shop&category='.$data['type'].'#corp"><span style="font-size:12px; color:#e87505;"><< Retour aux '.ucfirst($data['type']).'s</span></div></a>';
            }
            else
            {
              echo ERROR_010;
            }
          }
          else
          {
            echo ERROR_010;
          }
          break;
        case 'arme':
          echo '<div id="item_tooltip_top"></div>
            <div id="item_tooltip_middle">
            <table width="100%" border="0">
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=epee#corp">
                  <span style="font-size:14px; color:#e87505;">Epées</span>
                  <br />
                  <img src="images/shop/epees.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=baton#corp">
                  <span style="font-size:14px; color:#e87505;">Batons</span>
                  <br />
                  <img src="images/shop/batons.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=arc#corp">
                  <span style="font-size:14px; color:#e87505;">Arcs</span>
                  <br />
                  <img src="images/shop/arcs.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=baguette#corp">
                  <span style="font-size:14px; color:#e87505;">Baguettes</span>
                  <br />
                  <img src="images/shop/baguettes.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=dague#corp">
                  <span style="font-size:14px; color:#e87505;">Dagues</span>
                  <br />
                  <img src="images/shop/dagues.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=marteau#corp">
                  <span style="font-size:14px; color:#e87505;">Marteaux</span>
                  <br />
                  <img src="images/shop/marteaux.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=pelle#corp">
                  <span style="font-size:14px; color:#e87505;">Pelles</span>
                  <br />
                  <img src="images/shop/pelles.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=hache#corp">
                  <span style="font-size:14px; color:#e87505;">Haches</span>
                  <br />
                  <img src="images/shop/haches.png" />
                  </a>
                  </div>
                </td>
              </tr>
            </table>
            </div>
            <div id="item_tooltip_bottom"></div>
            <br /><div align="right"><a href="?page=shop#corp"><span style="font-size:12px; color:#e87505;"><< Retour</span></div></a>';
          break;
        default:
          echo '<div id="item_tooltip_top"></div>
            <div id="item_tooltip_middle">
            <table width="100%" border="0">';
          $sql = $this->dbOther->query("SELECT * FROM shop_list WHERE type = '".htmlentities($_GET['category'])."' ORDER BY id DESC");
          foreach ($sql as $data)
          {
            echo '<tr align="center">
                  <td><a href="?page=shop&category=details&id='.$data['id'].'#corp"><img src="'.$data['icon'].'" height="64" width="64" /></a></td>
                  <td><a href="?page=shop&category=details&id='.$data['id'].'#corp"><span style="font-size:14px; color:#a335ee;">'.$data['name'].'</span></a></td>
                  <td>'.$data['price'].' P</td>
                  <td><a href="?page=shop&category=details&id='.$data['id'].'#corp"><img src="images/moreinfo.png" /></a></td>
                </tr>';
          }
          echo '</table>
            </div>
            <div id="item_tooltip_bottom"></div>
            <br /><div align="right"><a href="?page=shop#corp"><span style="font-size:12px; color:#e87505;"><< Retour</span></div></a>';
          break;
        case 'home':
          echo '<div id="item_tooltip_top"></div>
            <div id="item_tooltip_middle">
            <table width="100%" border="0">
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=coiffe#corp">
                  <span style="font-size:14px; color:#e87505;">Coiffes</span>
                  <br />
                  <img src="images/shop/coiffes.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=cape#corp">
                  <span style="font-size:14px; color:#e87505;">Capes</span>
                  <br />
                  <img src="images/shop/capes.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=amulette#corp">
                  <span style="font-size:14px; color:#e87505;">Amulettes</span>
                  <br />
                  <img src="images/shop/amulettes.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=anneau#corp">
                  <span style="font-size:14px; color:#e87505;">Anneaux</span>
                  <br />
                  <img src="images/shop/anneaux.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=ceinture#corp">
                  <span style="font-size:14px; color:#e87505;">Ceintures</span>
                  <br />
                  <img src="images/shop/ceintures.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=botte#corp">
                  <span style="font-size:14px; color:#e87505;">Bottes</span>
                  <br />
                  <img src="images/shop/bottes.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=bouclier#corp">
                  <span style="font-size:14px; color:#e87505;">Boucliers</span>
                  <br />
                  <img src="images/shop/boucliers.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=arme#corp">
                  <span style="font-size:14px; color:#e87505;">Armes</span>
                  <br />
                  <img src="images/shop/armes.png" />
                  </a>
                  </div>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=familier#corp">
                  <span style="font-size:14px; color:#e87505;">Familiers</span>
                  <br />
                  <img src="images/shop/familiers.png" />
                  </a>
                  </div>
                </td>
                <td>
                  <div style="text-align: center;">
                  <a href="?page=shop&category=diver#corp">
                  <span style="font-size:14px; color:#e87505;">Divers</span>
                  <br />
                  <img src="images/shop/divers.png" />
                  </a>
                  </div>
                </td>
              </tr>
            </table>
            </div>
            <div id="item_tooltip_bottom"></div>';
          break;
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function shop_buy()
  {
    if($this->connect())
    {
      if(isset($_POST['id']) && $_POST['id'] != '')
      {
        $sql = $this->dbOther->query("SELECT * FROM shop_list WHERE id = '".htmlentities($_POST['id'])."'");
        $data = $sql->fetch(PDO::FETCH_ASSOC);
        if($sql->rowCount() > 0)
        {
          if($data['quant'] > 0)
          {
            $this->dbOther->query("INSERT INTO shop_panier (account,etat,article,item,name,type,price,reduc) VALUES ('".$_SESSION['guid']."','0','".$data['id']."','".$data['item']."','".$data['name']."','".$data['type']."','".$data['price']."','".$data['reduc']."')");
            header('location:?page=shop&category=details&id='.htmlentities($_POST['id']).'#corp');
          }
          else
          {
            echo INFO_003;
          }
        }
        else
        {
          echo ERROR_011;
        }
      }
      else
      {
        echo ERROR_011;
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function menu_panier()
  {
    echo '<div id="blockPanier">
        <img src="images/topBlockPanier.png">
          <div class="midBlockPanier">
            <div style="margin-left: 30px">';
    $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
    if($sql->rowCount() > 0)
    {
      echo '<table>
      <tr align="center">
        <th>Nom</th>
        <th>Type</th>
        <th>Prix</th>
      </tr>';

      $i = 0;
      $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
      foreach ($sql as $data)
      {
        echo '<tr align="center">
          <td><a href="?page=shop&category=details&id='.$data['article'].'#corp">'.$data['name'].'</a></td>
          <td>'.ucfirst($data['type']).'</td>
          '.($_SESSION['VIP'] == 2 ? '<td>'.($data['price']-($data['reduc']*$data['price']/100)).'</td>' : '<td>'.$data['price'].'</td>').'
        </tr>';
        if($_SESSION['VIP'] == 2)
        {
          if($i==0){ $total = ($data['price']-($data['reduc']*$data['price']/100)); }
          else{ $total = $total + ($data['price']-($data['reduc']*$data['price']/100)); }
        }
        else
        {
          if($i==0){ $total = $data['price']; }
          else{ $total = $total + $data['price']; }
        }
        $i++;
      }

      echo '<tr></tr>
      <tr align="center">
        <td>Total</td>
        <td></td>
        <td><b>'.($_SESSION['points'] >= $total ? '<font color="#005510">'.$total.'</font>' : '<font color="#6B0017">'.$total.'</font>').'</b></td>
      </tr>
      </table>
      <br />
      <div align="right" style="margin-right: 30px"><span class="modifier"><input type="submit" value="" onclick="self.location=\'?page=panier#corp\'" /></span><span class="acheter"><input type="submit" value="" onclick="self.location=\'?page=panier&action=buy#corp\'" /></span></div>';
      }
      else
      {
        echo '<div align="center" style="margin-top: -15px; margin-right: 30px; font-size:14px"><b><font color="#6B0017">Votre panier est vide</font></b></div>';
      }
      echo '</div>
          </div>
        <img src="images/bottomBlockPanier.png">
      </div>';
  }

  public function shop_panier()
  {
    if($this->connect())
    {
      echo '<span class="cambria orange italic size25">Panier</span>
        <br /><br />';
      switch(htmlentities(@$_GET['action']))
      {
        case 'historique':
          $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '1'");
          if($sql->rowCount() > 0)
          {
            echo '<div id="item_tooltip_top"></div>
            <div id="item_tooltip_middle">
            <div class="panier">
            <div align="center"><table width="97%">
            <tr align="center">
              <th>Nom</th>
              <th>Type</th>
              <th>Prix</th>
            </tr>';

            $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '1'");
            foreach ($sql as $data)
            {
              echo '<tr align="center">
                <td><a href="?page=shop&category=details&id='.$data['article'].'#corp">'.$data['name'].'</a></td>
                <td>'.ucfirst($data['type']).'</td>
                '.($_SESSION['VIP'] == 2 ? '<td>'.($data['price']-($data['reduc']*$data['price']/100)).'</td>' : '<td>'.$data['price'].'</td>').'
                </tr>';
            }

            echo '</table></div>
            </div>
            </div>
            <div id="item_tooltip_bottom"></div>';
          }
          break;
        case 'buy':
          $i=0;
          $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
          foreach ($sql as $data)
          {
            if($_SESSION['VIP'] == 2)
            {
              if($i==0){ $total = ($data['price']-($data['reduc']*$data['price']/100)); }
              else{ $total = $total + ($data['price']-($data['reduc']*$data['price']/100)); }
            }
            else
            {
              if($i==0){ $total = $data['price']; }
              else{ $total = $total + $data['price']; }
            }
            $i++;
          }

          if($total <= $_SESSION['points'])
          {
            $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
            foreach ($sql as $data)
            {
              $this->dbOther->query("INSERT INTO commandeboutique (IDCommande,Statut,Name) VALUES ('".$data['item']."','En attente','".$_SESSION['account']."')");
              $this->dbOther->query("UPDATE shop_panier SET etat = '1' WHERE id = '".$data['id']."'");
              $this->dbOther->query("UPDATE shop_list SET quant = quant - 1 WHERE id = '".$data['article']."'");
              if(file_exists('cache/page=shop&category=details&id='.$data['article'].'.html'))
              {
                unlink('cache/page=shop&category=details&id='.$data['article'].'.html');
              }
            }
            $this->dbOther->query("UPDATE accounts SET points = points - ".$total." WHERE guid = '".$_SESSION['guid']."'");
            $_SESSION['points'] = $_SESSION['points'] - $total;
            header('location:?page=panier&action=historique#corp');
          }
          else
          {
            echo ERROR_013;
          }
          break;
        case 'delete':
          if(isset($_GET['id']) && $_GET['id'] != '')
          {
            $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE id = '".htmlentities($_GET['id'])."'");
            $data = $sql->fetch(PDO::FETCH_ASSOC);
            if($sql->rowCount() > 0)
            {
              if($data['account'] == $_SESSION['guid'] && $data['etat'] == 0)
              {
                $this->dbOther->query("DELETE FROM shop_panier WHERE id = '".htmlentities($_GET['id'])."'");
                header('location:?page=panier#corp');
              }
              else
              {
                echo ERROR_012;
              }
            }
            else
            {
              echo ERROR_012;
            }
          }
          else
          {
            echo ERROR_012;
          }
          break;
        case 'deleteall':
          $this->dbOther->query("DELETE FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = 0");
          header('location:?page=panier#corp');
          break;
        default :
          $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
          if($sql->rowCount() > 0)
          {
            echo '<div id="item_tooltip_top"></div>
            <div id="item_tooltip_middle">
            <div class="panier">
            <div align="center"><table width="97%">
            <tr align="center">
              <th>Nom</th>
              <th>Type</th>
              <th>Prix</th>
              <th></th>
            </tr>';

            $i = 0;
            $sql = $this->dbOther->query("SELECT * FROM shop_panier WHERE account = '".$_SESSION['guid']."' AND etat = '0'");
            foreach ($sql as $data)
            {
              echo '<tr align="center">
                <td><a href="?page=shop&category=details&id='.$data['article'].'#corp">'.$data['name'].'</a></td>
                <td>'.ucfirst($data['type']).'</td>
                '.($_SESSION['VIP'] == 2 ? '<td>'.($data['price']-($data['reduc']*$data['price']/100)).'</td>' : '<td>'.$data['price'].'</td>').'
                <td><a href="?page=panier&action=delete&id='.$data['id'].'"><img src="images/cross.png" title="Retirer l\'article" /></a></td>
                </tr>';
              if($_SESSION['VIP'] == 2)
              {
                if($i==0){ $total = ($data['price']-($data['reduc']*$data['price']/100)); }
                else{ $total = $total + ($data['price']-($data['reduc']*$data['price']/100)); }
              }
              else
              {
                if($i==0){ $total = $data['price']; }
                else{ $total = $total + $data['price']; }
              }
              $i++;
            }

            echo '<tr></tr>
            <tr align="center">
              <td>Total</td>
              <td></td>
              <td><b>'.($_SESSION['points'] >= $total ? '<font color="#005510">'.$total.'</font>' : '<font color="#6B0017">'.$total.'</font>').'</b></td>
              <td><a href="?page=panier&action=deleteall"><img src="images/cross.png" title="Tout retirer les articles" /></a></td>
            </tr>
            </table>
            </div>
            </div>
            </div>
            <div id="item_tooltip_bottom"></div>
            <br />
            <div align="right"><span class="acheter"><input type="submit" value="" onclick="self.location=\'?page=panier&action=buy#corp\'" /></span></div>';
          }
          else
          {
            echo '<div class="panier" align="center" style="font-size:14px">
              <b><font color="#6B0017">Votre panier est vide</font></b>
              </div>';
          }
          break;
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function points()
  {
    if($this->connect())
    {
      echo '<span class="cambria orange italic size25">Acheter des Points</span>
        <br /><br />';
      switch(htmlentities(@$_GET['action']))
      {
        case 'end':
          if(isset($_COOKIE['points']) && $_COOKIE['points'] != '')
          {
            if($_COOKIE['points'])
            {
              echo SUCCES_004;
            }
            else
            {
              echo ERROR_015;
            }
            setcookie('points', '', 0);
          }
          else
          {
            echo ERROR_014;
          }
          break;
        case 'verif':
          $idp = $this->idp;
          $idd = $this->idd;
          $ident=$idp.";".@$ids.";".$idd;
          if(isset($_POST['code1']) && strlen($_POST['code1']) > 0) $code1 = $_POST['code1'];
          if(isset($_POST['code2']) && strlen($_POST['code2']) > 0) $code2 = ";".$_POST['code2'];
          if(isset($_POST['code3']) && strlen($_POST['code3']) > 0) $code3 = ";".$_POST['code3'];
          if(isset($_POST['code4']) && strlen($_POST['code4']) > 0) $code4 = ";".$_POST['code4'];
          $codes=$code1.$code2.$code3.$code4.$code5;
          $datas = $_POST['DATAS'];
          $ident=urlencode($ident);
          $codes=urlencode($codes);
          $datas=urlencode($datas);
          $get_c = @file("http://script.starpass.fr/check_php.php?ident=$ident&codes=$codes&DATAS=$datas");
          $exp = explode("|",$get_c[0]);
          if(substr($exp[0],0,3) == 'OUI')
          {
            if($_SESSION['VIP'] == 2)
            {
              $this->points = $this->points + $this->points_vip;
              $this->dbOther->query("UPDATE accounts SET points = points + $this->points WHERE guid = '".$_SESSION['guid']."'");
            }
            else
            {
              $this->dbOther->query("UPDATE accounts SET points = points + $this->points WHERE guid = '".$_SESSION['guid']."'");
            }
            $this->dbOther->query("INSERT INTO points_historique (account,code,points,pays,palier,id_palier,type) VALUES ('".$_SESSION['guid']."','".$code1."','".$this->points."','".$exp[2]."','".$exp[3]."','".$exp[4]."','".$exp[5]."')");
            $_SESSION['points'] = $_SESSION['points'] + $this->points;
            setcookie('points', 1);
            header('location:?page=points&action=end');
          }
          else
          {
            setcookie('points', 0);
            header('location:?page=points&action=end');
          }
          break;
        default :
          echo '<div align="center">
            L\'achat de points vous permettra de gagner <b>'.$this->points.'</b> Points (<b>'.($this->points+$this->points_vip).'</b> pour les VIPs).<br />
            Les micropaiements s\'effectue par <a href="http://www.starpass.fr/" target="_blank">StarPass™</a>, éditée par <a href="http://www.bdmultimedia.fr/" target="_blank">BD Multimédia</a><br /><br />
            <b>Pour obtenir vos codes d\'accès :</b><br /><br />
            Veuillez cliquer sur le drapeau de votre pays<br /><br />
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=fr&id_document='.$this->idd.'"><img src="images/flags/fr.png" title="France" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=fd&id_document='.$this->idd.'"><img src="images/flags/dom.png" title="DOM" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=be&id_document='.$this->idd.'"><img src="images/flags/be.png" title="Belgique" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=ch&id_document='.$this->idd.'"><img src="images/flags/ch.png" title="Suisse" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=lu&id_document='.$this->idd.'"><img src="images/flags/lu.png" title="Luxembourg" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=ca&id_document='.$this->idd.'"><img src="images/flags/ca.png" title="Canada" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=de&id_document='.$this->idd.'"><img src="images/flags/de.png" title="Allemagne" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=es&id_document='.$this->idd.'"><img src="images/flags/es.png" title="Espagne" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=uk&id_document='.$this->idd.'"><img src="images/flags/gb.png" title="Royaume-Uni" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=it&id_document='.$this->idd.'"><img src="images/flags/it.png" title="Italie" /></a>
            <a onclick="window.open(this.href,\'StarPass\',\'width=400,height=300,scrollbars=yes,resizable=yes\');return false;" href="http://script.starpass.fr/numero_pays_v3.php?pays=at&id_document='.$this->idd.'"><img src="images/flags/at.png" title="Autriche" /></a>
            <br /><br />
            Veuillez entrer votre code<br /><br />
            <form method="post" action="?page=points&action=verif">
              <input type="text" name="code1" value="" maxlength="8" />
              <input type="submit" name="send" value="Envoyer" />
            </form>
          </div>';
          break;
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function ladder()
  {
    echo '<span class="cambria orange italic size25">Classement</span>
      <br /><br />
      <div id="item_tooltip_top"></div>
      <div id="item_tooltip_middle">
      <div align="center">
      <table border="0" width="95%">
      <th>Position</th>
      <th>Nom</th>
      <th>Classe</th>
      <th>Sexe</th>
      <th>Niveau</th>
      <th>Alignement</th>';
    $i=1;
    $sql = $this->dbOther->query("SELECT * FROM personnages ORDER BY xp DESC LIMIT 0,20");
    foreach ($sql as $data)
    {
      if(!in_array($data['name'],$this->ladder_blacklist))
      {
        echo ''.($i < 4 ? '<tr class="Ladder'.$i.'" align="center">' : '<tr align="center">').'
          <td>'.($i < 4 ? '<img src="images/icons/ladder'.$i.'.png" />' : ''.$i.'').'</td>
          <td><a href="">'.($i < 4 ? '<font color="black">'.$data['name'].'</font>' : ''.$data['name'].'').'</a></td>
          <td><img src="images/icons/class_'.$data['class'].'.png" title="'.$this->class_name($data['class']).'" width="22" height="22" /></td>
          <td><img src="images/icons/sexe_'.$data['sexe'].'.png" title="'.$this->sexe_name($data['sexe']).'" /></td>
          <td>'.$data['level'].'</td>
          <td><img src="images/icons/align_'.$data['alignement'].'.png" title="'.$this->align_name($data['alignement']).'" width="22" height="22" /></td>
        <tr>';
        $i++;
      } 
    }
    echo '</table>
      </div>
      </div>
      <div id="item_tooltip_bottom"></div>';
  }

  public function article()
  {  
    if(isset($_GET['id']) && $_GET['id'] != '')
    {
      $sql = $this->dbOther->query("SELECT * FROM news WHERE id = '".htmlentities($_GET['id'])."'");
      $data = $sql->fetch(PDO::FETCH_ASSOC);
      if($sql->rowCount() > 0)
      {
        echo '<img src="images/top.png" />
          <div id="mid_corp">
            <div id="text_corp">
              <div class="titre">'.$data['title'].'</div>
              '.($data['image_view'] == 1 ? '<div class="avatar"><img src="'.$data['image_url'].'" /></div>' : null).'
              '.$data['content'].'
              <div style="width:100px;height:1px;clear:both;"></div>
              <div class="date">Ecrit par <b>'.$data['author'].'</b> le '.$this->date_fr('l d F Y à H:i',strtotime($data['date'])).'</div>
            </div>
          </div>
          <img src="images/bottom.png" />';
        if($data['com'])
        {
          $sql = $this->dbOther->query("SELECT * FROM commentaires WHERE news = '".htmlentities($_GET['id'])."'");
          if($sql->rowCount() > 0)
          {
            $sql = $this->dbOther->query("SELECT COUNT(id) as nbComs FROM commentaires WHERE news = '".htmlentities($_GET['id'])."'");
            $data = $sql->fetch(PDO::FETCH_ASSOC);
            $nbComs = $data['nbComs'];
            $nbPage = ceil($nbComs/10);
            if(isset($_GET['p']) && $_GET['p'] > 0 && $_GET['p'] <= $nbPage)
            {
              $cPage = $_GET['p'];
            }
            else
            {
              $cPage = 1;
            }

            $sql = $this->dbOther->query("SELECT * FROM commentaires WHERE news = '".htmlentities($_GET['id'])."' ORDER BY id DESC LIMIT ".(($cPage-1)*10).",10");
            foreach ($sql as $data)
            {
              echo '<img src="images/top.png" />
              <div id="mid_corp">
                <div id="text_corp">
                  '.$data['content'].'
                  <div style="width:100px;height:1px;clear:both;"></div>
                  <div class="date">Ecrit par <b>'.$data['author'].'</b> le '.$this->date_fr('l d F Y à H:i',strtotime($data['date'])).'</div>
                </div>
              </div>
              <img src="images/bottom.png" />';
            }

            if(@$nbComs > 0)
            {
              echo '<img src="images/top.png" />
              <div id="mid_corp">
                <div id="text_corp">
                  <center>Pages : ';
              for($i=1;$i<=$nbPage;$i++)
              {
                if($i==$cPage)
                {
                  echo '<a href="?page=article&id='.htmlentities($_GET['id']).'&p='.$i.'"><b>'.$i.'</b></a> ';
                }
                else
                {
                  echo '<a href="?page=article&id='.htmlentities($_GET['id']).'&p='.$i.'">'.$i.'</a> ';
                }
              }
              echo '<br /><a href="?page=commentaire&id='.htmlentities($_GET['id']).'">Ajouter un commentaire</a></center>
              </div>
              </div>
              <img src="images/bottom.png" />';
            }
          }
          else
          {
            echo '<img src="images/top.png" />
            <div id="mid_corp">
              <div id="text_corp">
                <center>Aucun commentaires<br /><a href="?page=commentaire&id='.htmlentities($_GET['id']).'">Ajouter un commentaire</a></center>
              </div>
            </div>
            <img src="images/bottom.png" />';
          }

//           echo '<img src="images/top.png" />
//              <div id="mid_corp">
//                <div id="text_corp">';
//
//          if($this->connect())
//          {
//            if(isset($_SESSION['CharacterPrincipal']) && $_SESSION['CharacterPrincipal'] != '0')
//            {
//              echo '<br />
//                <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
//                <script type="text/javascript" src="markitup/jquery.markitup.js"></script>
//                <script type="text/javascript" src="markitup/markitup_textarea.js"></script>
//                <script type="text/javascript" src="markitup/sets/bbcode/set.js"></script>
//                <link rel="stylesheet" type="text/css" href="markitup/skins/simple/style.css" />
//                <link rel="stylesheet" type="text/css" href="markitup/sets/bbcode/style.css" />
//                <form method="post" action="?page=commentaire">
//                  <input type="hidden" name="news" value="'.htmlentities($_GET['id']).'" />
//                  <textarea name="content" id="markItUp" cols="50" rows="10" style="color: white; background-color: #252525; border-color: #252525;"></textarea>
//                  <center><input type="submit" /></center>
//                </form>
//                <br />';
//            }
//            else
//            {
//              echo ERROR_016;
//            }
//          }
//          else
//          {
//            echo ERROR_004;
//          }
//
//          echo '</div>
//              </div>
//              <img src="images/bottom.png" />';
        }
        else
        {
          echo '<img src="images/top.png" />
              <div id="mid_corp">
                <div id="text_corp">
                '.INFO_004.'
                </div>
            </div>
            <img src="images/bottom.png" />';
        }
      }
      else
      {
        echo '<img src="images/top.png" />
              <div id="mid_corp">
                <div id="text_corp">
                '.ERROR_017.'
                </div>
            </div>
            <img src="images/bottom.png" />';
      }
    }
  }

  public function commentaire()
  {
    global $bbcode;

    echo '<span class="cambria orange italic size25">Ajouter un commentaire</span>
        <br /><br />';

    if($this->connect())
    {
      if(isset($_POST['news']) && $_POST['news'] != '')
      {
        if(empty($_COOKIE['flood_time']))
        {
          $sql = $this->dbOther->query("SELECT * FROM news WHERE id = '".htmlentities($_POST['news'])."'");
          if($sql->rowCount() > 0)
          {
            if(isset($_POST['content']) && $_POST['content'] != '')
            {
              $sql = $this->dbOther->query("SELECT * FROM personnages WHERE guid = '".$_SESSION['CharacterPrincipal']."'");
              $data = $sql->fetch(PDO::FETCH_ASSOC);
              $this->dbOther->query("INSERT INTO commentaires (content,author,news) VALUES ('".$bbcode->BBCodeM(htmlentities($_POST['content']))."','".$data['name']."','".htmlentities($_POST['news'])."')");
              setcookie('flood_time', '1', time()+60);
              if(file_exists('cache/page=article&id='.$_POST['news'].'.html'))
              {
                unlink('cache/page=article&id='.$_POST['news'].'.html');
              }
              header('location:?page=article&id='.$_POST['news']);
            }
            else
            {
              echo ERROR_001;
            }
          }
          else
          {
            header('location:?page=home');
          }
        }
        else
        {
          echo INFO_005;
        }
      }
      else
      {
        if(isset($_GET['id']) && $_GET['id'] != '')
        {
          $sql = $this->dbOther->query("SELECT * FROM news WHERE id = '".htmlentities($_GET['id'])."'");
          if($sql->rowCount() > 0)
          {
            if(isset($_SESSION['CharacterPrincipal']) && $_SESSION['CharacterPrincipal'] != '0')
            {
              echo '<br />
                <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
                <script type="text/javascript" src="markitup/jquery.markitup.js"></script>
                <script type="text/javascript" src="markitup/markitup_textarea.js"></script>
                <script type="text/javascript" src="markitup/sets/bbcode/set.js"></script>
                <link rel="stylesheet" type="text/css" href="markitup/skins/simple/style.css" />
                <link rel="stylesheet" type="text/css" href="markitup/sets/bbcode/style.css" />
                <form method="post" action="#">
                  <input type="hidden" name="news" value="'.htmlentities($_GET['id']).'" />
                  <textarea name="content" id="markItUp" cols="50" rows="10" style="color: white; background-color: #252525; border-color: #252525;"></textarea>
                  <div class="envoyer"><center><input type="submit" name="send" value=" " /></center></div>
                </form>
                <br />';
            }
            else
            {
              echo ERROR_016;
            }
          }
          else
          {
            echo ERROR_017;
          }
        }
        else
        {
          header('location:?page=home');
        }
      }
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function ban_ip() // REDOUTABLE !!
  {
    if(empty($_COOKIE['ban_time']))
    {
      setcookie('ban_time', '1', time()+120);
      $sql = $this->dbOther->query("SELECT * FROM ban_ip WHERE IP = '".$_SERVER['REMOTE_ADDR']."'");
      if($sql->rowCount() > 0)
      {
        $_SESSION['ban'] = 'TRUE';
        return TRUE;
      }
      else
      {
        return FALSE;
      }
    }
    else
    {
      if(isset($_SESSION['ban']) && $_SESSION['ban'] == 'TRUE')
      {
        return TRUE;
      }
      else
      {
        return FALSE;
      }
    }
  }

    public function ban_page()
  {
    $sql = $this->dbOther->query("SELECT * FROM ban_ip WHERE IP = '".$_SERVER['REMOTE_ADDR']."'");
    $data = $sql->fetch(PDO::FETCH_ASSOC);

    if($data['expire'] != '0000-00-00 00:00:00')
    {
      if(date('Y-m-d H:i:s') > $data['expire'])
      {
        $sql = $this->dbOther->query("DELETE FROM ban_ip WHERE IP = '".$_SERVER['REMOTE_ADDR']."'");
        session_unset();
        session_destroy();
        setcookie('ban_time');
        header('location:?page=home');
      }
    }

    echo '<center>
      <b>Vous êtes banni !</b><br /><br />
      <img src="images/cranes.png" /><br /><br />
      <table border="0">
      <tr><td align="left">Banni le : </td><td align="left">'.$this->date_fr('l d F Y à H:i',strtotime($data['date'])).'</td></tr>
      <tr><td align="left">Raison : </td><td align="left">'.$data['raison'].'</td></tr>
      <tr><td align="left">Expire le : </td><td align="left">'.($data['expire'] == '0000-00-00 00:00:00' ? 'Jamais' : $this->date_fr('l d F Y à H:i',strtotime($data['expire']))).'</td></tr>
      </table>
      </center>';
//    $sql = $this->dbOther->query("UPDATE ban_ip SET expire = '2011-03-04 20:59:17 ' WHERE IP = '".$_SERVER['REMOTE_ADDR']."'"); // A utilié pour le panel admin
  }

  public function contact()
  {
    global $bbcode;

    if($this->connect())
    {
      if(isset($_POST['send']) && $_POST['send'] != '')
      {
        if(empty($_COOKIE['flood_time']))
        {
          if(isset($_POST['content']) && $_POST['content'] != '' && isset($_POST['object']) && $_POST['object'] != '')
          {
            $this->dbOther->query("INSERT INTO contact (account,object,content) VALUES ('".$_SESSION['guid']."','".htmlentities($_POST['object'])."','".$bbcode->BBCodeM($_POST['content'])."')");
            setcookie('flood_time', '1', time()+60);
            echo SUCCES_005;
          }
          else
          {
            echo ERROR_001;
          }
        }
        else
        {
          echo INFO_005;
        }
      }

      echo '<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
        <script type="text/javascript" src="markitup/jquery.markitup.js"></script>
        <script type="text/javascript" src="markitup/markitup_textarea.js"></script>
        <script type="text/javascript" src="markitup/sets/bbcode/set.js"></script>
        <link rel="stylesheet" type="text/css" href="markitup/skins/simple/style.css" />
        <link rel="stylesheet" type="text/css" href="markitup/sets/bbcode/style.css" />
        <span class="cambria orange italic size25">Contact</span>
        <br /><br />
        Sur cette page vous pourrez prendre contact avec l\'équipe de Nestrya, pour cela, veuillez exposer votre requête grâce au formulaire ci-dessous.<br />
        Nous vous invitons à visitez notre <a href="?page=faq" title="Foire aux Questions">FAQ</a> avant utilisation du service d\'assistance.<br /><br />
        <form method="post" action="#">
          <label for="object">Objet :</label><br />
          <input type="text" id="object" name="object" value="'.(isset($_GET['A']) && $_GET['A'] != '' ? '#'.htmlentities($_GET['A']).'# : ' : '').'" /><br /><br />
          Message :<br />
          <textarea name="content" id="markItUp" cols="50" rows="20" style="color: white; background-color: #252525; border-color: #252525;"></textarea>
          <div class="envoyer"><center><input type="submit" name="send" value=" " /></center></div>
        </form>
        <br />';
    }
    else
    {
      echo ERROR_004;
    }
  }

  public function vote()
  {
    if($this->connect())
    {
      $time = time()+7200; // 2h ou 120m (Temps entre chaque vote RPG Paradize)
      $this->dbOther->query("DELETE FROM votes WHERE time < '".time()."'");
      $sql = $this->dbOther->query("SELECT * FROM votes WHERE IP = '".$_SERVER['REMOTE_ADDR']."'");
      $data = $sql->fetch(PDO::FETCH_ASSOC);
      if($sql->rowCount() > 0)
      {
        $count_time = (int)(($data['time']-time())/60);
        echo 'Vous devez attendre '.$count_time.' minutes avant de pouvoir re-voter.';
      }
      else
      {
        $this->dbOther->query("INSERT INTO votes (IP,time) VALUES ('".$_SERVER['REMOTE_ADDR']."', '".$time."')");
        $this->dbOther->query("UPDATE accounts SET points = points + '".$this->points_vote."', votes = votes + 1 WHERE guid = '".$_SESSION['guid']."'");
        header('Location:'.$this->vote_link.'');
      }
    }
    else
    {
      echo 'Attention, vous n\'êtes pas connecté, vous ne recevrais pas vos point.
        <br /><br />
        <a href="'.$this->vote_link.'">Voter</a>';
    }
  }

  public function devtool()
  {
    if($this->connect())
    {
      if($this->admin(5))
      {
        echo '<div id="WebDebug">
          <div id="WebDebugBar">
            <a href="#" onclick="WebDebugToggleMenu(); return false;"><img src="images/devtool/terminal.png" alt="Debug toolbar" /></a>
            <ul id="WebDebugDetails" class="WebDebugMenu">
              <li><span id="WebDebugSymfonyVersion">0.9</span></li>

              <li class="WebDebugInfo"><a title="Open" href="?page=home"><img src="images/devtool/open.png" alt="Open" /></a></li>

<<<<<<< .mine
              <li class="WebDebugInfo"><a title="Configuration" href="#" onclick="DevTool(\'config\');return false;"><img src="images/devtool/config.png" alt="Config" /> config</a></li>
              <li class="WebDebugInfo"><a title="Membres" href="#" onclick="DevTool(\'membre\');return false;"><img src="images/devtool/membre.png" alt="Membre" /> membres</a></li>
              <li class="WebDebugInfo"><a title="Commentaires" href="#" onclick="DevTool(\'commentaire\');return false;"><img src="images/devtool/view.png" alt="Commentaires" /> commentaire</a></li>
              <li class="WebDebugInfo"><a title="News" href="#" onclick="DevTool(\'news\');return false;"><img src="images/devtool/write.png" alt="News" /> news</a></li>
              <li class="WebDebugInfo"><a title="Bannissement" href="#" onclick="DevTool(\'bannissement\');return false;"><img src="images/devtool/ip.png" alt="Bann" /> bannissement</a></li>
              <li class="WebDebugInfo"><a title="Maintenance" href="#" onclick="DevTool(\'maintenance\');return false;"><img src="images/devtool/maintenance.png" alt="maintenance" /> maitenance</a></li>
              <li class="WebDebugInfo"><a title="Logs" href="#" onclick="DevTool(\'forbidden\');return false;"><img src="images/devtool/log.png" alt="Logs" /> logs</a></li>
=======
              <li class="WebDebugInfo"><a title="Configuration" href="#" onclick="DevTool(\'config\');"><img src="images/devtool/config.png" alt="Config" /> config</a></li>
              <li class="WebDebugInfo"><a title="Membres" href="#" onclick="DevTool(\'membre\');"><img src="images/devtool/membre.png" alt="Membre" /> membres</a></li>
              <li class="WebDebugInfo"><a title="Commentaires" href="#" onclick="DevTool(\'commentaire\');"><img src="images/devtool/view.png" alt="Commentaires" /> commentaire</a></li>
              <li class="WebDebugInfo"><a title="News" href="#" onclick="DevTool();"><img src="images/devtool/write.png" alt="News" /> news</a></li>
              <li class="WebDebugInfo"><a title="Bannissement" href="#" onclick="DevTool(\'bannissement\');"><img src="images/devtool/ip.png" alt="Bann" /> bannissement</a></li>
              <li class="WebDebugInfo"><a title="Maintenance" href="#" onclick="DevTool(\'maintenance\');"><img src="images/devtool/maintenance.png" alt="maintenance" /> maintenance</a></li>
              <li class="WebDebugInfo"><a title="Logs" href="#" onclick="DevTool(\'forbidden\');"><img src="images/devtool/log.png" alt="Logs" /> logs</a></li>
>>>>>>> .r84

              <li class="WebDebugInfo"><img src="images/devtool/time.png" alt="Time" /> <span id="date_heure"></span><script type="text/javascript">window.onload = date_heure(\'date_heure\');</script></li>
              <li class="last"><a href="#" onclick="document.getElementById(\'WebDebug\').style.display=\'none\'; return false;"><img src="images/devtool/close.png" alt="Close" /></a></li>
            </ul>
          </div>
        </div>
        <div id="DevTool" title="CP Admin" style="font-size: 12px; font-family: Arial, sans-serif;"></div>';
      }
    }
  }
  
  public function event()
  {
    echo '<span style="float:right"><img src="images/event/guerrier.png" /></span>
      <span class="cambria orange italic size25">Bonta VS Brakmar</span>
      <div style="margin-top:10px;border-left:5px solid #FF2424;padding:15px;-moz-border-radius:5px;width:550px;" class="c_99CEE0 size15 justify bgbox1_n">
        <b>Objectif</b> :
        <ul>
          <li>Tuez le plus de combattants de l\'équipe adverse.</li>
        </ul>
        <b>Récompense</b> :
        <ul>
          <li>300 Victoires <span class="red2">--» Panoplie & Emote du Champion + Accès VIP</span></li>
          <li>250 Victoires <span class="red2">--» Accès VIP</span></li>
          <li>200 Victoires <span class="red2">--» 200 Points</span></li>
          <li>150 Victoires <span class="red2">--» 150 Points</span></li>
          <li>100 Victoires <span class="red2">--» 100 Points</span></li>
          <li>&nbsp; 50 Victoires <span class="red2">--» 50 Points</span></li>
        </ul>
          <b>Durée</b> :
        <ul>
          <li>Une semaine, le week-end est consacré aux combats des plus puissants.</li>
        </ul>
      </div>';
  }

}
?>